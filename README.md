# Домашнее задание к занятию "Базы данных и их типы" - Чеклин Иван Михайлович

### Задание 1 СУБД

Кейс

Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для каждой предметной области.

Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему?

#### 1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков. СУБД должна гарантировать целостность и чёткую структуру данных.

Целостность и четкую структуру данных лучше всего обеспечивает реляционная БД.
В данном случае сложность может возникнуть при составлении аналитических отчетов, для аналитики хорошо подходят колоночные БД.
Однако основа системы все-таки бюджетирование, поэтому наилучшим выбором будет реляционная БД.

#### 1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы?

Для ускорения работы можно использовать такие API как xxHash (есть библиотеки для C, Python, Java, Go) или HighwayHash, разработанный Google.
Первый проверен временем, на данный момент считается одним из самых быстрых алгоритмов.
Второй использует параллельную обработку данныхобеспечивает скорость до 10Гб/с

#### 1.2. Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? СУБД должны быть гибкими и быстрыми.

Для сбора лидов лучшим выбором будет документоориентированная БД. Это связано с тем, что на разных лендингах могут быть формы разного содержания, а, значит, нужна БД с гибкой структурой. Поскольку в документоориентированных БД нет предварительного описания таблиц (полей), то это и будет оптимальным выбором.
Для CRM-системы нужен разумный балланс между надежностью и гибкостью.
Поэтому тут хорошо может подойти такая СУБД, как PostgreSQL с поддержкой JSONB. Структурированные проля таблицы, общие для всех проектов обеспечивают стабильность. А гибкость достигается за счет  JSON объектов внутри таблицы.

#### 1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?

Частично на этот вопрос уже приведен ответ в предыдущем вопросе.
Можно не устраивать сложную гибридную структуру с документоориентированной БД для сбора лидов и PostgreSQL для CRM, а реализовать все на основе PostgreSQL с поддержкой JSON.
В качестве минусов можно предположить некоторую потерю гибкости, но при упрощении системы упрощается и ее поддержка.


#### 1.3. Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.

Для описания структуры компании лучше всего подойдет графовая БД, поскольку основная информация - это связи между подразделениями компании.
А для хранения нормативной документации нужна документоориентированная БД.
Тут решающим будет конкретная структура компании.
Если она очень сложная и разветвленная, то нужно делать основу на графовой БД.
Если же структура состоит примерно из "двух отделов", то подойдет документоориентированная БД для хранения самих нормативных документов.

#### 1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это реализовать?

На мой взгляд графовая БД будет нужна при уж очень большой и сложной структуре. В большинстве случаев это будет документоориент ированная БД.
А такая уже использовалась в сборе лидов.
Остается решить вопрос в целесообразности совмещения настолько рахзной информации в одной БД.
Возможно имеет смысл реализовать две базы одного типа, но с разным содержанием.

#### 1.4. Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать со связями.

Для решения задач логистики однозначно лучшим выбором будет графовая СУБД, поскольку вся логистика это пункты, связи между ними. Это согласно математической теории и есть граф.

#### 1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД логистов?

Поскольку в сторительстве закупки напрямую связаны с логистикой, то именно к этой БД необходимо подключать и отдел закупок. Так он сможет сразу видеть всю цепочку поставок и вовремя реагировать на возможные задачи.

#### 1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?

Исходя из той информации, которую мне удалось найти - все эти задачи в той или иной мере закрываются решениями PostgreSQL с различными расштирениями (например поддержка JSON, pgRouting и др.)

---

### Задание 2 Транзакции

#### 2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы транзакция завершилась успешно. Ориентируйтесь на шесть действий.

- Пользователь начинает платеж 
- Считать состояние банковского счета и счета телефона
- Заблокировать средства на банковском счету
- Добавить средства на счет телефона
- Списать средства с банковского счета
- Разблокировать средства на счете телефона

#### 2.1.* Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?

То же, только начинается не с действий пользователя, а со срабатывания сигнала в системе банка.

---

### Задание 3 SQL vs NoSQL

#### 3.1. Напишите пять преимуществ SQL-систем по отношению к NoSQL.

1. Строгая структура данных. Поля таблиц настроены, архитектура БД спроектирована перед запуском. Также типы данных в полях неизменны, в таком виде с ними легче работать.
2. Язык SQL давно разработан, достаточно прост в изучении и использовании. Универсален.
3. Отсутствие избыточности. Данные в реляционных БД нормализуются, убираются излишние данные. Расчетные поля не хранятся. Это позволяет избежать множества ошибок.
4. Подержка принципов ACID дает высокую надежность транзакций.
5. Реляционные БД развиваются достаточно давно, чтобы накопилось много разнообразных инструментов для работы. Можно подобрать удобный инструмент для каждого конкретного случая. 

#### 3.1.* Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.

NewSQL это попытка объединить преимущества SQL и NoSQL.
То есть сохранить надежность реляционной БД и масштабируемость NoSQL.
Однако похоже, что это еще очень свежий, "сырой" подход. Нужно тестировать, чтобы убедиться в его работоспособности.

### Задание 4

#### Необходимо производить большое количество вычислений при работе с огромным количеством данных, под эту задачу выделено 1000 машин. На основе какого критерия будете выбирать тип СУБД и какая модель распределённых вычислений здесь справится лучше всего и почему?

Главный критерий - теорема CAP (Consistency, Availability, Partition Tolerance). При этом для кластера из 1000 машин решающим становится фактор Partition Tolerance (P). 
Далее нужно будет определить что важнее - быстрый отклик (Доступность и Устойчивость) или точность вычислений (CP - Согласованность и Устойчивость).

Лучше всего подойдет NoSQL с моделью вычислений MapReduce.
Такая система позволит обеспечить:
- Принцип "Вычисления к данным", когда не данные перекачиваются по сети, а код для вычислений хзагружается на машины, где данные лежат
- Масштабируемость, к 1000 машин можно легко присоединить дополнительные
- Отказоустойчивость. Если некоторые машины выйдут из строя - их вычисления будут перенаправлены на другие машины в кластере.
